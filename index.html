<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Workspace Admin Quiz</title>
    <style>
        :root {
            --primary: #1a73e8; /* Google Blue */
            --success: #1e8e3e; /* Google Green */
            --error: #d93025;   /* Google Red */
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #202124;
            --shadow: 0 1px 2px 0 rgba(60,64,67,0.3), 0 2px 6px 2px rgba(60,64,67,0.15);
        }

        body {
            font-family: 'Google Sans', Roboto, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            background-color: var(--card-bg);
            width: 100%;
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
        }

        h1 { margin: 0; font-size: 1.3rem; color: #5f6368; }
        
        .score-pill {
            background: #e8f0fe;
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .container {
            width: 100%;
            max-width: 700px;
            margin: 20px auto;
            padding: 0 15px;
            box-sizing: border-box;
        }

        .card {
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .q-header {
            display: flex;
            justify-content: space-between;
            color: #80868b;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .q-text {
            font-size: 1.1rem;
            line-height: 1.5;
            margin-bottom: 25px;
            color: #202124;
            white-space: pre-wrap;
        }

        .options-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-btn {
            background: #fff;
            border: 1px solid #dadce0;
            border-radius: 4px;
            padding: 12px 16px;
            text-align: left;
            cursor: pointer;
            font-size: 0.95rem;
            color: #3c4043;
            transition: all 0.2s;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #f8f9fa;
            border-color: #80868b;
        }

        /* Selection States */
        .option-btn.selected {
            background-color: #e8f0fe;
            border-color: var(--primary);
            color: var(--primary);
            font-weight: 500;
        }

        .option-btn.correct {
            background-color: #ceead6;
            border-color: var(--success);
            color: #0d652d;
            font-weight: 500;
        }

        .option-btn.wrong {
            background-color: #fad2cf;
            border-color: var(--error);
            color: #a50e0e;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 1; 
        }

        /* Feedback Area */
        .feedback {
            margin-top: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 5px solid #ccc;
            display: none;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feedback.correct { border-left-color: var(--success); background-color: #f6ffed; }
        .feedback.wrong { border-left-color: var(--error); background-color: #fff2f0; }

        .fb-title { font-weight: bold; margin-bottom: 5px; display: block; }
        .fb-expl { font-size: 0.9rem; color: #444; line-height: 1.5; }

        /* Next Button */
        .next-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            float: right;
            display: none;
        }
        .next-btn:hover { background-color: #174ea6; }

        /* End Screen */
        .end-screen { text-align: center; display: none; }
        .score-big { font-size: 3rem; font-weight: bold; color: var(--primary); margin: 20px 0; }
        .restart-btn {
            background: white;
            border: 1px solid #dadce0;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            color: var(--primary);
        }
        .restart-btn:hover { background: #f1f3f4; }
        
        .instruction {
            font-size: 0.85rem;
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: bold;
            text-transform: uppercase;
        }

        @media (max-width: 600px) {
            .card { padding: 20px; }
            h1 { font-size: 1.1rem; }
        }
    </style>
</head>
<body>

<header>
    <h1>Workspace Master Quiz</h1>
    <div class="score-pill">Score: <span id="score">0</span></div>
</header>

<div class="container">
    <div class="card" id="quiz-card">
        <div class="q-header">
            <span id="progress">Question 1</span>
            <span id="q-id">ID: 001</span>
        </div>

        <div class="instruction" id="instruction"></div>
        <div class="q-text" id="q-text"></div>
        <div class="options-list" id="options"></div>

        <div class="feedback" id="feedback">
            <span class="fb-title" id="fb-title"></span>
            <div class="fb-expl" id="fb-expl"></div>
        </div>

        <button class="next-btn" id="next-btn" onclick="nextQuestion()">Next Question</button>
        <div style="clear:both;"></div>
    </div>

    <div class="card end-screen" id="end-screen">
        <h2>Quiz Complete</h2>
        <p>Your final score:</p>
        <div class="score-big" id="final-score"></div>
        <p id="final-stats"></p>
        <button class="restart-btn" onclick="startQuiz()">Restart Quiz</button>
    </div>
</div>

<script>
    // --- MERGED DATA SOURCE (Untitled + Workspace_Exam) ---
    const rawDeck = [
        // Questions 1-72 from Untitled Document
        { id: 1, q: "Audit requiring preservation of all communications (Email, Chat, Drive) for a specific project. How to configure Vault?", options: ["A. Security investigation report", "B. Search and export", "C. Create a matter and a hold on all project-related data sources", "D. Custom retention policy"], a: ["C"], expl: "Holds are required to preserve data indefinitely for legal discovery, overriding retention rules." },
        { id: 2, q: "Need confidential group for finance project. Minimize management overhead. What to do?", options: ["A. GCDS sync", "B. Dynamic group based on Department attribute (Finance)", "C. Open group", "D. Group with admin"], a: ["B"], expl: "Dynamic groups automate membership based on attributes like Department, reducing overhead." },
        { id: 3, q: "Signed up for Business Starter with existing domain. Cannot create users or change settings. What to do?", options: ["A. Transfer tool", "B. Check domain ownership in DNS settings", "C. Wait 24h", "D. Upgrade"], a: ["B"], expl: "Domain verification is required to unlock full admin features." },
        { id: 4, q: "Temp employees left. Need to disable accounts but preserve Vault data for 2 years. Minimize cost.", options: ["A. Archived User (AU) licenses", "B. Transfer files and delete", "C. Suspend and keep license", "D. Move to OU and disable"], a: ["A"], expl: "AU licenses preserve Vault data at a fraction of the cost of full licenses." },
        { id: 5, q: "Legal needs specific M&A emails from employee on leave. Ensure privacy.", options: ["A. IT forwards emails", "B. Legal access to account", "C. Delegate access", "D. Vault matter > Search > Export > Share"], a: ["D"], expl: "Vault allows targeted search/export for legal needs without granting full mailbox access." },
        { id: 6, q: "Prevent unauthorized forwarding of internal newsletter to external addresses. Allow internal sharing.", options: ["A. Warning banner", "B. Gmail content compliance rule targeting newsletter to reject external forwarding", "C. Apps Script", "D. Subject line modification"], a: ["B"], expl: "Content compliance rules can filter based on content and recipient (internal vs external)." },
        { id: 7, q: "Ensure sensitive project data in Drive is limited to internal sharing only. Not overly restrictive.", options: ["A. Domain internal only", "B. Allowlisted domains", "C. Drive DLP rule using Project Name as detector", "D. Turn off sharing"], a: ["C"], expl: "DLP allows specific content-based restrictions rather than blanket domain blocks." },
        { id: 8, q: "Users received phishing from fake HR. Identify recipients and prevent recurrence.", options: ["A. Email Log Search", "B. Mark phishing in Investigation Tool + Block sender", "C. Vault export", "D. Investigation Tool > Delete messages > Turn on spoofing/auth safety settings"], a: ["D"], expl: "Investigation tool deletes the bad emails; Safety settings prevent future spoofing." },
        { id: 9, q: "Make prototype room bookable by Innovation and Sales Directors only.", options: ["A. Groups + Share Calendar", "B. Separate resource", "C. Calendar Resource > Adjust permission settings to specific groups", "D. Calendar Event"], a: ["C"], expl: "Resource permissions control who can book specific rooms." },
        { id: 10, q: "Notify compliance team when user updates/resets password.", options: ["A. Activity rule triggered by Password Changed event", "B. Password policy", "C. Alert center", "D. Compliance OU"], a: ["A"], expl: "Activity rules allow automated alerts for specific audit events." },
        { id: 11, q: "Prevent access to malicious external Drive files, allow legitimate ones. (Choose two)", options: ["A. Security awareness training", "B. Malware detection", "C. Password policy", "D. Drive trust rule blocking all external except allowed partners"], a: ["A", "D"], expl: "Trust rules whitelist partners; Training helps users identify risks." },
        { id: 12, q: "Cost-effective customer support email, requests evenly distributed.", options: ["A. Google Group (Collaborative Inbox) with 'Anyone on web' posting", "B. Shared credentials", "C. Public group", "D. Delegated access"], a: ["A"], expl: "Collaborative inboxes allow assignment/tracking without shared passwords." },
        { id: 13, q: "Legitimate external emails going to spam. Fix without risk.", options: ["A. DMARC", "B. Spam settings > Add sender IPs to email allowlist", "C. Address list", "D. Mark as not spam"], a: ["B"], expl: "IP Allowlisting bypasses spam filters for trusted sources." },
        { id: 14, q: "Allow security team to use Investigation Tool. Least privilege.", options: ["A. Admin role with Security Center access", "B. User Mgmt role", "C. Activity rule", "D. Super Admin"], a: ["A"], expl: "Custom role with specific Security Center rights avoids Super Admin risks." },
        { id: 15, q: "Preserve project communications for audit (Repeat of Q1).", options: ["A. Report", "B. Retention policy", "C. Matter and Hold", "D. Search export"], a: ["C"], expl: "Holds are for indefinite preservation." },
        { id: 16, q: "Web/mobile approval app, no dev budget.", options: ["A. AppSheet", "B. Internal dev", "C. Apps Script", "D. Manual"], a: ["A"], expl: "AppSheet is the no-code solution for Workspace." },
        { id: 17, q: "Automatically classify Drive files based on content.", options: ["A. 3rd party", "B. OU defaults", "C. Drive DLP rules applying labels", "D. Manual labels"], a: ["C"], expl: "DLP can scan content (like PII) and auto-apply labels." },
        { id: 18, q: "Create many conference rooms efficiently.", options: ["A. Individually", "B. 3rd party", "C. Bulk upload (CSV) in Admin Console", "D. API"], a: ["C"], expl: "Bulk upload is the standard efficient method." },
        { id: 19, q: "Prevent users from joining external Google Groups.", options: ["A. View permissions", "B. 'Accessing groups from outside this organization' = Private", "C. Directory API", "D. Groups OFF"], a: ["B"], expl: "This setting restricts interaction with external groups." },
        { id: 20, q: "Restrict Chrome extensions regardless of user login device.", options: ["A. Device list", "B. Require users to sign-in to Chrome", "C. Policy precedence", "D. 2SV"], a: ["B"], expl: "User policies (like extension blocks) only apply if the user signs into the browser." },
        { id: 21, q: "Task force (15 users, 5 depts) needs Google Sites. Least disruptive.", options: ["A. Access group", "B. Configuration Group", "C. New OU", "D. Individual"], a: ["B"], expl: "Configuration groups apply service settings across OUs." },
        { id: 22, q: "User needs to find files labeled 'contracts'.", options: ["A. Keyword search", "B. Investigation tool", "C. Search for files labeled 'contracts'", "D. API"], a: ["C"], expl: "Users can search by label metadata." },
        { id: 23, q: "Terminated employee. Preserve docs for manager. Minimize cost.", options: ["A. Suspend", "B. Reset pwd", "C. Switch to Archived User license", "D. Delete"], a: ["C"], expl: "AU license is cheaper than Enterprise Standard and keeps data." },
        { id: 24, q: "Automated app with connectors to external/Sheets data. Mobile ready.", options: ["A. App Engine", "B. BigQuery", "C. AppSheet", "D. Apps Script"], a: ["C"], expl: "AppSheet connects data sources to mobile apps." },
        { id: 25, q: "Sync 3000 external contacts from Exchange to Gmail directory.", options: ["A. CSV import", "B. Google Cloud Directory Sync (GCDS)", "C. API", "D. Manual"], a: ["B"], expl: "GCDS syncs LDAP/Exchange data to Workspace." },
        { id: 26, q: "Secure user accounts against unauthorized access. Best practice.", options: ["A. Disable recovery", "B. SMS 2SV", "C. Physical Security Keys", "D. Complex pwd"], a: ["C"], expl: "Security Keys are the strongest 2SV method." },
        { id: 27, q: "Handle PHI (Protected Health Info) compliance.", options: ["A. Backup", "B. Create Drive Label for sensitive data", "C. Do not store", "D. Disable apps"], a: ["B"], expl: "Labels help classify and manage sensitive data like PHI." },
        { id: 28, q: "Quickly review security risks (Gmail, Drive, etc).", options: ["A. Reports", "B. Alerts", "C. OUs", "D. Security Health Page"], a: ["D"], expl: "Security Health Page gives a consolidated risk overview." },
        { id: 29, q: "Ensure former employee data remains in Vault. Cost effective.", options: ["A. Migrate", "B. Pwd change", "C. Suspend account and move to OU", "D. Archived User"], a: ["C"], expl: "Suspended accounts retain data. (Note: AU license is also valid, but 'Suspend' is often the 'free' correct answer in older contexts. Based on source text: C)." },
        { id: 30, q: "Troubleshoot intermittent Gmail slowness/errors.", options: ["A. Dashboard", "B. Generate HAR file", "C. Other device", "D. Clear cache"], a: ["B"], expl: "HAR files capture network traffic for diagnosis." },
        { id: 31, q: "Remove work email from personal phone when employee leaves.", options: ["A. Basic mgmt", "B. Advanced Mobile Management", "C. Data rules", "D. 2SV"], a: ["B"], expl: "Advanced Management allows selective wipe of work data." },
        { id: 32, q: "Offboard employee. Manager needs access to My Drive files.", options: ["A. Vault", "B. Share", "C. Takeout", "D. Transfer ownership during deletion"], a: ["D"], expl: "Built-in transfer tool during deletion." },
        { id: 33, q: "Mobile: Passcode + Remote Wipe + NO agents.", options: ["A. Advanced", "B. Basic Management", "C. Password policy", "D. MDM"], a: ["B"], expl: "Basic is agentless but allows wipe/passcode." },
        { id: 34, q: "Litigation hold. Preserve all project data indefinitely.", options: ["A. Create Vault Hold", "B. AU license", "C. Retention rule", "D. Export"], a: ["A"], expl: "Holds override everything else." },
        { id: 35, q: "Enforce complex password policy (AD synced via GCDS).", options: ["A. Instructions", "B. Workspace policy", "C. AD policy", "D. Create policy in AD + Enable pwd sync in GCDS"], a: ["D"], expl: "Passwords must be managed at the IdP (AD) source." },
        { id: 36, q: "Prevent Drive access when traveling internationally.", options: ["A. Disable Drive", "B. Context-Aware Access (Location based)", "C. 2SV", "D. User levels"], a: ["B"], expl: "Context-Aware Access controls based on IP/Geo." },
        { id: 37, q: "Mobile: Passcode + Wipe. No agents. iOS & Android.", options: ["A. EMM", "B. Hybrid", "C. Basic", "D. Advanced Management"], a: ["D"], expl: "Advanced Management is required for full wipe/passcode consistency without 3rd party MDM." },
        { id: 38, q: "Remediate suspicious HR phishing email.", options: ["A. Investigation Tool > Mark as Phishing", "B. Mark spam", "C. Rule", "D. Notify"], a: ["A"], expl: "Marking as phishing removes it from inboxes." },
        { id: 39, q: "Investigate data breach. See devices/apps used.", options: ["A. User accounts", "B. Investigate tool", "C. Reports", "D. Audit Log (Device/App activity)"], a: ["D"], expl: "Audit logs show raw device access events." },
        { id: 40, q: "Sharing: R&D can share external, Finance cannot.", options: ["A. Vault", "B. Drive trust rules", "C. DLP", "D. Separate domain"], a: ["B"], expl: "Trust rules allow OU-based sharing boundaries." },
        { id: 41, q: "Cloud Identity users authenticate via 3rd party SSO (SAML).", options: ["A. 2FA", "B. Google Sign-in", "C. API", "D. Create SAML App in Admin Console"], a: ["D"], expl: "Configures Google as Service Provider." },
        { id: 42, q: "New user unable to access Meet (License OK).", options: ["A. Verify Meet service is enabled for user's OU", "B. Browser", "C. Restart", "D. Cache"], a: ["A"], expl: "Service ON/OFF is the first check." },
        { id: 43, q: "Shared Chromebooks. No local data. Clear on exit.", options: ["A. Guest", "B. Force Ephemeral Mode + Disable Offline", "C. Incognito", "D. Ephemeral + Offline"], a: ["B"], expl: "Ephemeral clears profile; No offline prevents caching." },
        { id: 44, q: "Migrating email to Workspace. Route mail to Gmail.", options: ["A. Change MX records", "B. Compliance rule", "C. Forwarding", "D. SPF"], a: ["A"], expl: "MX records control delivery." },
        { id: 45, q: "Sharing: Sales OK, Engineering NO.", options: ["A. OUs", "B. Shared drives", "C. DLP", "D. Drive Trust Rules"], a: ["D"], expl: "Trust rules are preferred for granular sharing control." },
        { id: 46, q: "Share patient docs with billing company (Edit OK, Delete NO).", options: ["A. Content Manager", "B. Editor", "C. Shared Drive > Contributor Access", "D. DLP"], a: ["C"], expl: "Contributor allows add/edit but no delete." },
        { id: 47, q: "Acquired agency. Users need new email AND old domain email.", options: ["A. Send-as", "B. Secondary Domain", "C. Primary", "D. Alias"], a: ["B"], expl: "Secondary domain allows distinct user identities/emails." },
        { id: 48, q: "Shared Drive: Group needs Add/Edit. Single user needs Move/Delete.", options: ["A. Folder", "B. Link", "C. Individual", "D. Group=Contributor, Single=Content Manager"], a: ["D"], expl: "Contributor=Edit; Content Manager=Delete." },
        { id: 49, q: "Massive legitimate email going to spam.", options: ["A. Compliance", "B. Allowlist", "C. Disable filter", "D. Contact Support"], a: ["D"], expl: "System-wide failure requires Support intervention." },
        { id: 50, q: "Block unapproved extensions, allow vetted list.", options: ["A. Allow all", "B. Block All + Allowlist vetted apps", "C. Disable", "D. Disable Store"], a: ["B"], expl: "Whitelist approach." },
        { id: 51, q: "Secure email to Banks (Maximize privacy).", options: ["A. TLS Compliance", "B. SPF", "C. Unauthenticated protection", "D. Confidential mode"], a: ["A"], expl: "TLS encrypts the pipe." },
        { id: 52, q: "Force password change if 20 failed attempts.", options: ["A. Chrome rule", "B. Activity Rule (User Log)", "C. Live state", "D. Alert"], a: ["B"], expl: "Activity rules automate responses to log events." },
        { id: 53, q: "End unsupervised Meet meetings quickly.", options: ["A. Meet APIs", "B. Host mgmt", "C. Turn off", "D. Investigation tool"], a: ["A"], expl: "APIs allow programmatic ending of meetings." },
        { id: 54, q: "Limit live-streaming to affiliated domains.", options: ["A. Trusted", "B. Off", "C. Add participants to OU > Turn on", "D. In-house"], a: ["C"], expl: "OU-based restriction." },
        { id: 55, q: "Block specific file types in email.", options: ["A. Size", "B. Sandbox", "C. 3rd party", "D. Attachment compliance rule"], a: ["D"], expl: "Native blocking feature." },
        { id: 56, q: "Trusted employees need to remove Chat messages/ban users.", options: ["A. Assign as Space Managers/Moderators", "B. DLP", "C. Investigate", "D. Disable"], a: ["A"], expl: "Moderators manage space content." },
        { id: 57, q: "Increase storage for subset of Sales users (10GB -> 100GB).", options: ["A. Move subset to sub-OU > Assign limit", "B. Shared Drive", "C. Change whole OU", "D. Group"], a: ["A"], expl: "Storage is typically managed by OU settings." },
        { id: 58, q: "Diagnose Meet audio issues (can't hear presenters).", options: ["A. Drivers", "B. Admin alerts", "C. Context aware", "D. Meet Quality Tool"], a: ["D"], expl: "Quality Tool shows bitrates/packet loss/device status." },
        { id: 59, q: "Identify missing emails (Root cause). (Choose two)", options: ["A. Email Log Search", "B. Verify MX", "C. Spam", "D. Logs", "E. IP"], a: ["A", "B"], expl: "Log Search finds the message; MX confirms the route exists." },
        { id: 60, q: "Shared Drive access based on Job Role (Auto add/remove).", options: ["A. Security group", "B. Dist list", "C. Dynamic Group", "D. Config group"], a: ["C"], expl: "Dynamic groups query user attributes." },
        { id: 61, q: "Exec Admin needs to manage Exec email (No password sharing).", options: ["A. Forward", "B. Password", "C. Group", "D. Delegated Access"], a: ["D"], expl: "Delegation is the secure method." },
        { id: 62, q: "Receive email for new domain 'terramearth.com'.", options: ["A. Add domain + Update MX", "B. TLS", "C. Catch-all", "D. Alias"], a: ["A"], expl: "Must add domain and point MX records." },
        { id: 63, q: "Calendar invites from dept not received. No error logs.", options: ["A. Analyze headers in Admin Toolbox", "B. Permissions", "C. Restart", "D. Settings"], a: ["A"], expl: "Headers reveal delivery path issues." },
        { id: 64, q: "Update many conference rooms (names/capacities).", options: ["A. Bulk CSV export/import", "B. Manual", "C. New", "D. Delete/Recreate"], a: ["A"], expl: "Bulk CSV is best for updates." },
        { id: 65, q: "Calendar room suggestions based on location.", options: ["A. Define Buildings/Floors/Sections", "B. Dynamic", "C. Groups", "D. OUs"], a: ["A"], expl: "Structured resources enable proximity suggestions." },
        { id: 66, q: "Increase Unauthorized Access attempts. Enhance security.", options: ["A. Disable recovery", "B. SMS", "C. Physical Security Keys", "D. Complex pwd"], a: ["C"], expl: "Security keys are the gold standard." },
        { id: 67, q: "User reported spam. Find details/scope.", options: ["A. Investigation Tool", "B. API", "C. Report search", "D. Vault"], a: ["A"], expl: "Investigation tool is for real-time threat scoping." },
        { id: 68, q: "Onboard new employee with Company Android. Enforce strong security.", options: ["A. 3rd Party", "B. Personal", "C. Basic", "D. Advanced Management"], a: ["D"], expl: "Company-owned + Strong Security = Advanced Management." },
        { id: 69, q: "Google Voice issues (Local vs Broad?).", options: ["A. Logs", "B. Status Dashboard", "C. Licenses", "D. Blog"], a: ["B"], expl: "Dashboard shows system-wide outages." },
        { id: 70, q: "Auto-install Chrome extensions.", options: ["A. Force-install via Policy", "B. Web store", "C. Allowlist", "D. Script"], a: ["A"], expl: "Force-install pushes the app to the browser." },
        { id: 71, q: "Gmail loading errors. Troubleshoot.", options: ["A. Browser", "B. Fwd", "C. HAR files", "D. Labels"], a: ["C"], expl: "HAR files debug network/loading issues." },
        { id: 72, q: "Chat History: Default ON, allow users to turn OFF.", options: ["A. Top-level ON, allow change", "B. Space OFF", "C. Top-level OFF", "D. Vault"], a: ["A"], expl: "Sets default while allowing user override." },

        // --- NEW QUESTIONS FROM WORKSPACE_EXAM.MD ---
        { id: 73, q: "Regulatory requirement: German data in Europe, US data in US. How to configure?", options: ["A. Drive for desktop", "B. Trust rules", "C. Data Regions (Europe for Germany OU, US for US OU)", "D. No preference"], a: ["C"], expl: "Data Regions allow specifying geographic storage locations by OU." },
        { id: 95, q: "Legal investigation. Preserve employee Drive data for 1 year. Vault default is 5.", options: ["A. Create a Hold", "B. Custom retention rule", "C. Change default", "D. Check default"], a: ["A"], expl: "Holds override retention rules. (Note: A custom retention rule of 1 year might delete data after 1 year, whereas a Hold guarantees preservation *at least* that long, but usually indefinite. Question implies preservation amidst potential deletion. Hold is safest for investigation)." },
        { id: 96, q: "Alert if user downloads >500 Drive files in 1 hour.", options: ["A. DLP", "B. Alert center", "C. Activity Rule in Security Investigation Tool", "D. Cloud Monitoring"], a: ["C"], expl: "Activity rules can trigger alerts based on log threshold (download count)." },
        { id: 97, q: "New Marketplace app not working (Cant access contacts/email). Check first?", options: ["A. Logs", "B. App Access setting", "C. Check OAuth Scopes/Grant access", "D. Subscription"], a: ["C"], expl: "Apps need API scopes granted to access data." },
        { id: 98, q: "External collab with users who don't have Google Accounts. Secure sharing.", options: ["A. External sharing", "B. Allowlist", "C. Create accounts", "D. Visitor Sharing"], a: ["D"], expl: "Visitor sharing allows PIN-based access for non-Google accounts." },
        { id: 99, q: "Suspicious Drive usage (external sharing). Identify users.", options: ["A. Activity rule", "B. Security health", "C. Policies", "D. Security Investigation Tool"], a: ["D"], expl: "Investigation tool allows searching logs for specific events like external sharing." },
        { id: 100, q: "Manage Chrome browsers cost-effectively.", options: ["A. Wipe", "B. Enroll in Cloud Management (Chrome Browser Cloud Management)", "C. 3rd party", "D. Disable extensions"], a: ["B"], expl: "CBCM is the free/included method to manage browsers centrally." },
        { id: 101, q: "Rise in unauthorized access from personal devices. Restrict access immediately.", options: ["A. DLP", "B. Context-Aware Access (limit to company devices)", "C. Limited access", "D. MFA"], a: ["B"], expl: "CAA can block access based on device management state." },
        { id: 102, q: "Acquired company. Need to send/receive from OLD and NEW domains.", options: ["A. Secondary", "B. Alias Domain", "C. MX change", "D. Routing"], a: ["B"], expl: "If they just need to receive/send as the old domain on their new accounts, an Alias domain is simplest. (Source says B)." },
        { id: 103, q: "Global org (US/EU). Ensure user data sits in their region.", options: ["A. No pref", "B. Enable multi-region", "C. Disable multi-region", "D. Set Data Region policy per OU"], a: ["D"], expl: "Data Regions are applied per Organizational Unit." },
        { id: 104, q: "Data Regions for Americas, Europe, Asia Pacific.", options: ["A. Groups", "B. US/EU/No Pref", "C. Parent", "D. Select specific regions for each OU"], a: ["D"], expl: "Map OUs to their respective Data Regions." },
        { id: 105, q: "Prevent unauthorized Meet access and protect info.", options: ["A. Meet Safety Settings", "B. Gemini", "C. Audit log", "D. Dial-in"], a: ["A"], expl: "Safety settings control entry (Quick access, etc)." },
        { id: 106, q: "Dedicated Vault Auditor. Read-only access to Policies/Matters. No changes.", options: ["A. Super Admin restricted", "B. Custom Role (View Retention, View Matters)", "C. View All Matters", "D. Manage Matters"], a: ["B"], expl: "Custom role with specific View privileges." },
        { id: 107, q: "BYOD program. Ensure lost device data is secure (including local).", options: ["A. Advanced Mobile Management", "B. Encryption req", "C. Certs", "D. Basic"], a: ["A"], expl: "Advanced management is required to wipe the work profile/device thoroughly." },
        { id: 108, q: "Employee accessed confidential Drive label. Restrict access immediately.", options: ["A. Set Label permissions", "B. Apply label", "C. Disable", "D. Policy"], a: ["A"], expl: "Labels have their own permission controls." }
    ];

    // --- GAME STATE ---
    let shuffledDeck = [];
    let currentIndex = 0;
    let score = 0;
    let isAnswered = false;

    // --- DOM ---
    const ui = {
        card: document.getElementById('quiz-card'),
        endScreen: document.getElementById('end-screen'),
        progress: document.getElementById('progress'),
        qId: document.getElementById('q-id'),
        instruction: document.getElementById('instruction'),
        qText: document.getElementById('q-text'),
        options: document.getElementById('options'),
        feedback: document.getElementById('feedback'),
        fbTitle: document.getElementById('fb-title'),
        fbExpl: document.getElementById('fb-expl'),
        nextBtn: document.getElementById('next-btn'),
        score: document.getElementById('score'),
        finalScore: document.getElementById('final-score'),
        finalStats: document.getElementById('final-stats')
    };

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    function startQuiz() {
        shuffledDeck = shuffle([...rawDeck]);
        currentIndex = 0;
        score = 0;
        ui.score.innerText = 0;
        ui.card.style.display = 'block';
        ui.endScreen.style.display = 'none';
        loadQuestion();
    }

    function loadQuestion() {
        isAnswered = false;
        const q = shuffledDeck[currentIndex];
        const total = shuffledDeck.length;

        // Reset UI
        ui.progress.innerText = `Question ${currentIndex + 1} of ${total}`;
        ui.qId.innerText = `ID: ${q.id}`;
        ui.qText.innerText = q.q;
        ui.feedback.style.display = 'none';
        ui.feedback.className = 'feedback'; // reset classes
        ui.nextBtn.style.display = 'none';
        ui.options.innerHTML = '';

        // Instructions
        const isMulti = q.a.length > 1;
        ui.instruction.innerText = isMulti ? `Select ${q.a.length} Answers` : "Select 1 Answer";

        // Create Buttons
        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => handleAnswer(btn, opt, q);
            ui.options.appendChild(btn);
        });

        // Current Selection Tracker (for multi)
        ui.currentSelection = [];
    }

    function handleAnswer(btn, text, q) {
        if (isAnswered) return;

        const isMulti = q.a.length > 1;
        const letter = text.trim().charAt(0).toUpperCase();

        if (isMulti) {
            // Toggle selection
            if (ui.currentSelection.includes(letter)) {
                ui.currentSelection = ui.currentSelection.filter(l => l !== letter);
                btn.classList.remove('selected');
            } else {
                if (ui.currentSelection.length < q.a.length) {
                    ui.currentSelection.push(letter);
                    btn.classList.add('selected');
                }
            }
            // Check if ready
            if (ui.currentSelection.length === q.a.length) {
                checkResult(ui.currentSelection, q);
            }
        } else {
            // Single choice
            checkResult([letter], q);
        }
    }

    function checkResult(userAnswers, q) {
        isAnswered = true;
        
        // Sort for comparison
        const sortedUser = [...userAnswers].sort().join('');
        const sortedCorrect = [...q.a].sort().join('');
        const isCorrect = sortedUser === sortedCorrect;

        // Visuals
        const btns = ui.options.querySelectorAll('.option-btn');
        btns.forEach(btn => {
            btn.disabled = true;
            const btnLetter = btn.innerText.trim().charAt(0).toUpperCase();
            
            // Highlight Correct
            if (q.a.includes(btnLetter)) {
                btn.classList.add('correct');
            }
            // Highlight Wrong User Selection
            if (userAnswers.includes(btnLetter) && !q.a.includes(btnLetter)) {
                btn.classList.add('wrong');
            }
        });

        // Update Score
        if (isCorrect) {
            score++;
            ui.score.innerText = score;
            ui.feedback.classList.add('correct');
            ui.fbTitle.innerText = "Correct!";
        } else {
            ui.feedback.classList.add('wrong');
            ui.fbTitle.innerText = "Incorrect";
        }

        ui.fbExpl.innerText = q.expl || "No explanation provided.";
        ui.feedback.style.display = 'block';
        ui.nextBtn.style.display = 'block';
    }

    function nextQuestion() {
        if (currentIndex < shuffledDeck.length - 1) {
            currentIndex++;
            loadQuestion();
        } else {
            endQuiz();
        }
    }

    function endQuiz() {
        ui.card.style.display = 'none';
        ui.endScreen.style.display = 'block';
        const pct = Math.round((score / shuffledDeck.length) * 100);
        ui.finalScore.innerText = `${pct}%`;
        ui.finalStats.innerText = `You answered ${score} out of ${shuffledDeck.length} correctly.`;
    }

    // Start
    startQuiz();
</script>

</body>
</html>
